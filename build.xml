<project name="umlgraph" default="compile" basedir=".">
<description>
	The specification for the Java-based umlgraph build processes.
	$Id$
</description>

<!-- set global properties for this build -->
<property name="src" location="src"/>
<property name="build" location="build"/>
<property name="lib" location="lib"/>
<property name="testsrc" location="test/src"/>
<!-- import environment variables
<property environment="env"/>
-->


<target name="init">
	<!-- Create the time stamp -->
	<tstamp/>
	<!-- Create the build directory structure used by compile -->
	<mkdir dir="${build}"/>
	<mkdir dir="${lib}"/>
	<mkdir dir="testdata/dot-out"/>
</target>

<target name="version">
	<echo>Version is ${VERSION}</echo>
	<echo file="src/gr/spinellis/umlgraph/doclet/Version.java">/* Automatically generated file */
package gr.spinellis.umlgraph.doclet;
class Version { public static String VERSION = "${VERSION}";}
	</echo>
</target>

<target name="compile" depends="init"
	description="compile the source, build library " >
	<javac srcdir="${src}" destdir="${build}" excludes="gr/spinellis/umlgraph/doclet/RCS/*,gr/spinellis/umlgraph/test/RCS/*"/>
	<jar basedir="${build}" destfile="${lib}/UmlGraph.jar" includes="gr/spinellis/umlgraph/doclet/*.class"/>
</target>

<target name="test" depends="compile"
	description="run the regression tests" >
	 <java classname="gr.spinellis.umlgraph.test.BasicTest" fork="true">
         <classpath>
	   <pathelement location="${env.JAVA_HOME}/lib/tools.jar"/>
           <pathelement location="${build}"/>
           <pathelement location="${lib}/UmlGraph.jar"/>
         </classpath>
       </java>
</target>

</project>
